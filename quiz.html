<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no"
  />
  <meta
    name="description"
    content="Cuestionario interactivo de filosofÃ­a. Pon a prueba tus conocimientos."
  />
  <meta
    name="keywords"
    content="filosofÃ­a, cuestionario, educaciÃ³n, Ã©tica, antropologÃ­a, existencialismo"
  />
  <meta name="author" content="Cuestionarios de FilosofÃ­a" />

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#667eea" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="FilosofÃ­a Quiz" />

  <!-- Favicon -->
  <link
    rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§ </text></svg>"
  />

  <title id="page-title">ğŸ§  Cuestionario de FilosofÃ­a</title>
  <link rel="stylesheet" href="css/quiz.css" />
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2>ğŸ§  Cargando cuestionario...</h2>
      <p id="loading-message">Preparando preguntas</p>
      <div class="loading-progress">
        <div class="loading-bar" id="loading-bar"></div>
      </div>
    </div>
  </div>

  <!-- Main Quiz Container -->
  <div id="quiz-container" class="quiz-container hidden">
    <!-- Header -->
    <header class="quiz-header">
      <div class="quiz-nav">
        <button id="back-btn" class="nav-btn">â† Volver a temas</button>
        <div class="theme-info">
          <span id="theme-icon" class="theme-icon">ğŸ§ </span>
          <span id="theme-title" class="theme-title">FilosofÃ­a</span>
        </div>
        <button id="help-btn" class="nav-btn">ğŸ“š Material</button>
      </div>
    </header>

    <!-- NEW: Level Tabs / Etapas -->
    <nav id="level-tabs" class="level-tabs">
      <button id="tab-concepts" class="level-tab active">1) Caza de conceptos</button>
      <button id="tab-synthesis" class="level-tab disabled" disabled>2) Frase sÃ­ntesis</button>
      <button id="tab-map" class="level-tab disabled" disabled>3) Mapa conceptual</button>
      <button id="tab-quiz" class="level-tab disabled" disabled>4) Quiz</button>
    </nav>

    <!-- Progress Section -->
    <div class="progress-section">
      <div class="progress-info">
        <div class="progress-item">
          <span class="progress-label">Etapa</span>
          <span id="stage-label" class="progress-value">Caza de conceptos</span>
        </div>
        <div class="progress-item">
          <span class="progress-label">Progreso</span>
          <span id="question-counter" class="progress-value">1/10</span>
        </div>
        <div class="progress-item">
          <span class="progress-label">Puntaje</span>
          <span id="score" class="progress-value">0</span>
        </div>
        <div class="progress-item">
          <span class="progress-label">Tiempo</span>
          <span id="timer" class="progress-value">30s</span>
        </div>
      </div>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <!-- NEW: Subprogreso para la etapa de caza de conceptos -->
      <div id="concept-progress" class="mini-progress hidden">
        <span class="progress-label">Conceptos del pÃ¡rrafo</span>
        <span id="concept-counter" class="progress-value">0/0</span>
      </div>
    </div>

    <!-- MAIN PHASES WRAPPER -->
    <main id="question-container" class="question-container">
      <!-- ========================= -->
      <!-- LEVEL 1: CONCEPT HUNT     -->
      <!-- ========================= -->
      <section id="concept-hunt-phase" class="phase concept-hunt-phase">
        <div class="phase-header">
          <h3>ğŸ” Caza de conceptos</h3>
          <p class="phase-desc">
            SeleccionÃ¡ las palabras o frases cortas que mejor condensan la idea del
            pÃ¡rrafo. CompletÃ¡ todas para desbloquear la sÃ­ntesis.
          </p>
        </div>

        <div class="concepts-wrapper">
          <!-- PÃ¡rrafo actual -->
          <article class="concept-paragraph-card">
            <header class="concept-paragraph-header">
              <span id="paragraph-index" class="badge">PÃ¡rrafo 1</span>
              <span id="concepts-remaining" class="badge info">Conceptos por descubrir: 0</span>
            </header>
            <p id="concept-paragraph-text" class="concept-paragraph-text">
              <!-- Texto del pÃ¡rrafo para selecciÃ³n interactiva -->
            </p>

            <!-- Indicador de intentos / feedback local -->
            <div id="concept-feedback" class="concept-feedback"></div>

            <div class="concept-actions">
              <button id="skip-paragraph-btn" class="tertiary-btn">â­ï¸ Siguiente pÃ¡rrafo</button>
              <button id="reveal-hints-btn" class="secondary-btn">ğŸ’¡ Pista</button>
            </div>
          </article>
        </div>

        <!-- NavegaciÃ³n nivel 1 -->
        <div class="phase-actions">
          <button id="to-synthesis-btn" class="primary-btn disabled" disabled>
            âœ… Pasar a 2) Frase sÃ­ntesis
          </button>
        </div>
      </section>

      <!-- ========================= -->
      <!-- LEVEL 2: SYNTHESIS        -->
      <!-- ========================= -->
      <section id="synthesis-phase" class="phase synthesis-phase hidden">
        <div class="phase-header">
          <h3>ğŸ§© Frase sÃ­ntesis</h3>
          <p class="phase-desc">
            ElegÃ­ la frase que mejor sintetiza el sentido del pÃ¡rrafo trabajado.
          </p>
        </div>

        <div class="synthesis-card">
          <header class="synthesis-header">
            <span id="synthesis-paragraph-index" class="badge">PÃ¡rrafo 1</span>
            <span id="synthesis-progress" class="badge info">0/0</span>
          </header>

          <p id="synthesis-paragraph-brief" class="synthesis-brief">
            <!-- (Opcional) breve recordatorio del pÃ¡rrafo -->
          </p>

          <div id="synthesis-options" class="synthesis-options">
            <!-- Botones de 3 opciones se renderizan aquÃ­ -->
          </div>

          <div id="synthesis-feedback" class="synthesis-feedback"></div>

          <div class="synthesis-actions">
            <button id="prev-synthesis" class="tertiary-btn">âŸµ Anterior</button>
            <button id="next-synthesis" class="secondary-btn">Siguiente âŸ¶</button>
          </div>
        </div>

        <!-- NavegaciÃ³n nivel 2 -->
        <div class="phase-actions">
          <button id="to-map-btn" class="primary-btn disabled" disabled>
            âœ… Pasar a 3) Mapa conceptual
          </button>
        </div>
      </section>

      <!-- ========================= -->
      <!-- LEVEL 3: CONCEPT MAP      -->
      <!-- ========================= -->
      <section id="concept-map-phase" class="phase concept-map-phase hidden">
        <div class="phase-header">
          <h3>ğŸ—ºï¸ Mapa conceptual</h3>
          <p class="phase-desc">
            OrganizÃ¡ los conceptos cazados en un esquema. Cuando completes los vÃ­nculos
            esenciales, se desbloquea el quiz.
          </p>
        </div>

        <div class="concept-map-wrapper">
          <!-- Ãrea para canvas/drag & drop o lista de nodos y conexiones -->
          <div id="concept-map-board" class="concept-map-board">
            <!-- El engine JS dibuja aquÃ­ los nodos/relaciones -->
          </div>

          <aside class="concept-map-sidebar">
            <div class="sidebar-section">
              <h4>Nodos</h4>
              <ul id="concept-map-nodes" class="node-list">
                <!-- Lista de nodos disponibles -->
              </ul>
            </div>
            <div class="sidebar-section">
              <h4>Relaciones</h4>
              <ul id="concept-map-edges" class="edge-list">
                <!-- Lista de relaciones creadas -->
              </ul>
            </div>
            <div class="sidebar-section">
              <h4>Progreso</h4>
              <div class="mini-progress">
                <span class="progress-label">VÃ­nculos nÃºcleo</span>
                <span id="map-core-counter" class="progress-value">0/0</span>
              </div>
            </div>
          </aside>
        </div>

        <!-- NavegaciÃ³n nivel 3 -->
        <div class="phase-actions">
          <button id="to-quiz-btn" class="primary-btn disabled" disabled>
            âœ… Pasar a 4) Quiz
          </button>
        </div>
      </section>

      <!-- ========================= -->
      <!-- LEVEL 4: QUIZ (original)  -->
      <!-- ========================= -->
      <section id="quiz-phase" class="phase quiz-phase hidden">
        <!-- Help Text Phase (se mantiene) -->
        <div id="help-phase" class="phase help-phase">
          <div class="help-content">
            <h3>ğŸ’¡ Pista</h3>
            <p id="help-text" class="help-text"></p>
            <div class="help-actions">
              <button id="show-question-btn" class="primary-btn">ğŸ“ Ver pregunta</button>
              <button id="show-material-btn" class="secondary-btn">ğŸ“– Consultar material</button>
            </div>
          </div>
        </div>

        <!-- Question Phase (se mantiene) -->
        <div id="question-phase" class="phase question-phase hidden">
          <div class="question-content">
            <h2 id="question-text" class="question-text"></h2>
            <div id="answers-container" class="answers-container"></div>
          </div>
        </div>

        <!-- Results Phase (se mantiene) -->
        <div id="results-phase" class="phase results-phase hidden">
          <div class="results-content">
            <div class="results-header">
              <div id="results-icon" class="results-icon">ğŸ‰</div>
              <h2 id="results-title" class="results-title">Â¡Cuestionario completado!</h2>
            </div>

            <div class="results-stats">
              <div class="stat-card">
                <div class="stat-number" id="final-score">0</div>
                <div class="stat-label">Puntaje final</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="correct-answers">0/10</div>
                <div class="stat-label">Respuestas correctas</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="total-time">0min</div>
                <div class="stat-label">Tiempo total</div>
              </div>
            </div>

            <div class="results-message" id="results-message">
              <p>Â¡Excelente trabajo! Has demostrado un buen dominio del tema.</p>
            </div>

            <div class="results-actions">
              <button id="retry-btn" class="primary-btn">ğŸ”„ Intentar de nuevo</button>
              <button id="themes-btn" class="secondary-btn">ğŸ  Otros temas</button>
              <button id="review-btn" class="tertiary-btn">ğŸ“‹ Revisar respuestas</button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Study Material Modal -->
  <div id="material-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title">ğŸ“– Material de Estudio</h3>
        <button class="close-btn" id="close-modal">&times;</button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- Contenido del material se carga aquÃ­ -->
      </div>
    </div>
  </div>

  <!-- Review Modal -->
  <div id="review-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ğŸ“‹ RevisiÃ³n de Respuestas</h3>
        <button class="close-btn" id="close-review">&times;</button>
      </div>
      <div class="modal-body" id="review-body">
        <!-- RevisiÃ³n de respuestas se genera aquÃ­ -->
      </div>
    </div>
  </div>

  <!-- Error Screen -->
  <div id="error-screen" class="error-screen hidden">
    <div class="error-content">
      <div class="error-icon">âŒ</div>
      <h2>Error al cargar el cuestionario</h2>
      <p id="error-message">No se pudo cargar el tema seleccionado.</p>
      <button id="retry-load-btn" class="primary-btn">ğŸ”„ Reintentar</button>
      <button id="back-to-themes-btn" class="secondary-btn">ğŸ  Volver a temas</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/quiz-engine.js"></script>
</body>
</html>
